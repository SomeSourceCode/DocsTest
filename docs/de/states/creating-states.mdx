---
title: Eigene States erstellen
shortTitle: States erstellen
description: Lerne, wie du eigene States in SomeGuiApi erstellen und verwenden kannst.
---

<Note>
	Wenn du nicht vorhast, eigene States zu verwenden und nur lernen möchtest, wie du mit den bereitgestellten arbeiten kannst, kannst du diese Seite überspringen.
</Note>

## States erstellen

Jeder Typ von State bietet eine einfache Implementierung, die dem `SimpleXState`-Muster folgt. Um beispielsweise einen State vom Typ `boolean` zu erstellen,
kannst du die Klasse `SimpleBooleanState` verwenden:

```java
BooleanState booleanState = new SimpleBooleanState();
```

Es gibt auch eine Überladung, die einen Anfangswert akzeptiert:

```java
IntegerState integerState = new SimpleIntegerState(42);
```

## Schreibgeschützte States

If you want to provide a read-only view of your state - for example when you're creating your own pane - you can use a `ReadOnlyStateWrapper`.\
Let's say you want to create a read-only `gamePhase`, you could implement it as follows:

Wenn du eine schreibgeschützte Ansicht deines States bereitstellen möchtest - zum Beispiel, wenn du deine eigene Pane erstellst - kannst du einen `ReadOnlyStateWrapper` verwenden.\
Angenommen, du möchtest eine schreibgeschützte `gamePhase` bereitstellen, könntest du sie wie folgt implementieren:

```java title="Game.java"
public class Game {

	// ...

	private ReadOnlyObjectWrapper<GamePhase> gamePhaseWrapper;

	private ReadOnlyObjectWrapper<GamePhase> gamePhaseStateWrapper() {
		if (gamePhaseWrapper == null) {
			gamePhaseWrapper = new ReadOnlyObjectWrapper<>(GamePhase.INITIAL);
		}
		return gamePhaseWrapper;
	}

	public ReadOnlyState<GamePhase> gamePhaseState() {
		return gamePhaseStateWrapper().readOnly();
	}

	public GamePhase getGamePhase() {
		return gamePhaseStateWrapper == null ? GamePhase.INITIAL : gamePhaseStateWrapper().get();
	}

	private void setGamePhase(GamePhase gamePhase) {
		gamePhaseStateWrapper().set(gamePhase);
	}

	// ...

}
```

Deutsch:
Wie du sehen kannst, verhält sich der Wrapper wie ein normaler State, bietet jedoch eine zusätzliche `readOnly()`-Methode, die eine schreibgeschützte Ansicht des States zurückgibt.
Das bedeutet, dass du innerhalb der `Game`-Instanz den `gamePhase`-State mit den `set`- und `get`-Methoden abrufen und festlegen kannst.\
\
Für einen externen Benutzer gibt die `gamePhaseState()`-Methode jedoch einen schreibgeschützten State zurück, was bedeutet, dass er nur Änderungen beobachten, aber den State nicht ändern kann.

<Info>
	There's a read-only wrapper for [each type of state](/states#types-of-states), such as `ReadOnlyBooleanWrapper`, `ReadOnlyIntegerWrapper`, etc.
</Info>

## Bereinigen (Sanitizing)

Im obigen Beispiel gibt es derzeit noch ein Problem: Die `GamePhase` kann auf `null` gesetzt werden, was kein gültiger Wert ist und in diesem Fall
nicht zulässig sein sollte. Um dies zu verhindern, können alle State-Implementierungen die Methode `sanitize` überschreiben, die aufgerufen wird,
_bevor_ der Wert gesetzt wird und festlegt, wie der neue Wert sein soll. Standardmäßig ändert sie diesen Wert nicht, aber Sie können sie überschreiben,
um Ihre eigene Logik zu implementieren.\
\
Um das obige Beispiel zu korrigieren, überschreiben wir die Methode `sanitize` im `gamePhaseWrapper`-Zustand:

```java title="Game.java"
// ...

private ReadOnlyObjectWrapper<GamePhase> gamePhaseStateWrapper() {
	if (gamePhaseWrapper == null) {
		gamePhaseWrapper = new ReadOnlyObjectWrapper<>(GamePhase.INITIAL) {
			// highlight-start
			@Override
			public GamePhase sanitize(GamePhase oldPhase, GamePhase newPhase) {
				if (newPhase == null) {
					return oldPhase;
				}
				return newPhase;
			}
			// highlight-end
		};
	}
	return gamePhaseWrapper;
}

// ...
```

Ein weiteres Beispiel dafür, was du tun könntest, ist die Einschränkung des Wertebereichs, z. B. nur Werte zwischen 0 und 100 für einen `IntegerState

```java
IntegerState integerState = new SimpleIntegerState() {
	@Override
	public Integer sanitize(Integer oldValue, Integer newValue) {
		return Math.clamp(newValue, 0, 100);
	}
};
```
